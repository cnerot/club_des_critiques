{% extends 'base.html.twig' %}

{% block title %}
    Inscription de nouveau membre
{% endblock %}

{% block body %}
    <div class="container">
    <input type="hidden" value="{{ salon.id }}" id="idSalon">
		<!-- Modal Trigger -->
		  <a id="alert" class="waves-effect waves-light btn hide" href="#modal2">Modal</a>

		  <!-- Modal Structure -->
		  <div id="modal2" class="modal">
			<div class="modal-content">
			  <div class="col s8 rateAbook left">
				<div id="nameAlert"></div>
			  </div>
			</div>
			<div class="modal-footer">
			  <a href="#!" class="closeWindowRateAbook modal-action modal-close waves-effect waves-green btn-flat">OK</a>
			</div>
		  </div>
		  
		<!-- Modal Structure -->
		<div id="modal1" class="modal">
			<div class="modal-content">
				<div id="myContacts" class="col s12 margin-top">
					<h4>Inviter des contacts</h4>
					<form method="POST" action="">
						<table class="table">
						  <thead>
							<tr class="<?php echo $themeApplicated->getPageStat(); ?>">
							  <th>Ajouter</th>
							  <th>Nom</th>
							</tr>
						  </thead>
						  <tbody class="">
							  <!--
							  <tr>
								  <td>
									<p>
									  <input type="checkbox" id="test5" name="myContacts[]">
									  <label for="test5"></label>
									</p>
								  </td>
								  <td>Paul Durand</td>
							  </tr>
							  
							  <tr>
								  <td>
									<p>
									  <input type="checkbox" id="test6" name="myContacts[]">
									  <label for="test6"></label>
									</p>
								  </td>
								  <td>Paul Durand</td>
							  </tr>
							  
							  <tr>
								  <td>
									<p>
									  <input type="checkbox" id="test7" name="myContacts[]">
									  <label for="test7"></label>
									</p>
								  </td>
								  <td>Paul Durand</td>
							  </tr>
							 -->
						  </tbody>
						</table>
						<input type="button" class="btn btn-primary" id="invitContact" value="Inviter">
					</form>
				</div>
			</div>
			
		<div class="modal-footer">
		  <a href="#!" class="closeWindowRateAbook modal-action modal-close waves-effect waves-green btn-flat">Annuler</a>
		</div>
		
	  </div>
	  
		<div class="row">
			<div class="col s12">
				<h1>Salon : {{ salon.titreSalon }} - <span id="nbParticipants">6</span> participants</h1>
			</div>
			<div id="chat" class="col l8 m12 s12 margin-top">
				<div id="posts" class="col s12 margin-top">
					<div class="post">
						<span class="name">
							Paul Durand
						</span>
						<span class="alertAbuse right">
							<a href="#">Signaler un abus</a>
						</span>
						<div class="clearfix"></div>
						<div class="text">&nbsp;&nbsp;&nbsp; <!-- alinéa -->
							Je trouve votre livre remarquable de part sa tendresse et son attendrissement devant les généalogies évidentes d'une population sincère et désordonnée.
						</div>
						<div class="date right">
							10/01/2016
						</div>
						<hr>
					</div>
					
					<div class="post">
						<span class="name">
							Paul Durand
						</span>
						<span class="alertAbuse right">
							<a href="#">Signaler un abus</a>
						</span>
						<div class="clearfix"></div>
						<div class="text">&nbsp;&nbsp;&nbsp; <!-- alinéa -->
							Je trouve votre livre remarquable de part sa tendresse et son attendrissement devant les généalogies évidentes d'une population sincère et désordonnée.
						</div>
						<div class="date right">
							10/01/2016
						</div>
						<hr>
					</div>
					
					<div class="post">
						<span class="name">
							Paul Durand
						</span>
						<span class="alertAbuse right">
							<a href="#">Signaler un abus</a>
						</span>
						<div class="clearfix"></div>
						<div class="text">&nbsp;&nbsp;&nbsp; <!-- alinéa -->
							Je trouve votre livre remarquable de part sa tendresse et son attendrissement devant les généalogies évidentes d'une population sincère et désordonnée.
						</div>
						<div class="date right">
							10/01/2016
						</div>
						<hr>
					</div>
				</div>
				<div id="message" class="col s12 margin-top">
					<textarea></textarea>
					
					<button id="send" class="col s12 btn-large right darken-3">
						Envoyer
					</button>
				</div>					
			</div>
			
			<div id="contacts" class="col l4 m12 s12 margin-top">
				<div id="participants" class="col s12 margin-top">
					<table class="table">
					  <thead>
						<tr class="<?php echo $themeApplicated->getPageStat(); ?>">
						  <th>Participants</th>
						  <th>Ajouter aux contact</th>
						  <th>Signaler un abus</th>
						</tr>
					  </thead>
					  <tbody class="">
						  {% for participant in participants %}
							  <tr>
								  <td>
									  <a href="#/{{ participant.idMembre }}" title="Voir le profil">{{ participant.nom }}</a>
									  <div>
										  <a href="#/{{ participant.idMembre }}" title="Participant pertinent dans ses propos" class="thumb_up"><i class="tiny material-icons">thumb_up</i></a>
										  <a href="#/{{ participant.idMembre }}" title="Participant non pertinent dans ses propos" class="thumb_down"><i class="verticalMiddle tiny material-icons">thumb_down</i></a>
									  </div>
								  </td>
								  <td>
									  <div class="">
										{% if participant.ami == "false" %}
										  <span title="Ajouter aux contact" class="btn-floating btn-small orange lighten-2 addToContacts" id="idMembre_{{ participant.idMembre }}"><i class="large material-icons">add</i></span>
										{% endif %}
									  </div>
								  </td>
								  <td>
									  <div class="">
										  <a title="Demande de bannissement" class="btn-floating btn-small red lighten-1" href="#/{{ participant.idMembre }}"><i class="large material-icons">block</i></a>
									  </div>
								  </td>
							  </tr>
						  {% endfor %}
						  <!-- <tr>
							  <td>
								  <a href="#" title="Voir le profil">Paul Durand</a>
								  <div>
									  <a href="#" title="Participant pertinent dans ses propos" class="thumb_up"><i class="tiny material-icons">thumb_up</i></a>
									  <a href="#" title="Participant non pertinent dans ses propos" class="thumb_down"><i class="verticalMiddle tiny material-icons">thumb_down</i></a>
								  </div>
							  </td>
							  <td>
								  <div class="">
									  <a title="Ajouter aux contact" class="btn-floating btn-small orange lighten-2" href="#"><i class="large material-icons">add</i></a>
								  </div>
							  </td>
							  <td>
								  <div class="">
									  <a title="Demande de bannissement" class="btn-floating btn-small red lighten-1" href="#"><i class="large material-icons">block</i></a>
								  </div>
							  </td>
						  </tr>
						  
						  
						  <tr>
							  <td>
								  <a href="#" title="Voir le profil">Paul Durand</a>
								  <div>
									  <a href="#" title="Participant pertinent dans ses propos" class="thumb_up"><i class="tiny material-icons">thumb_up</i></a>
									  <a href="#" title="Participant non pertinent dans ses propos" class="thumb_down"><i class="verticalMiddle tiny material-icons">thumb_down</i></a>
								  </div>
							  </td>
							  <td>
								  <div class="">
									  <a title="Ajouter aux contact" class="btn-floating btn-small orange lighten-2" href="#"><i class="large material-icons">add</i></a>
								  </div>
							  </td>
							  <td>
								  <div class="">
									  <a title="Demande de bannissement" class="btn-floating btn-small red lighten-1" href="#"><i class="large material-icons">block</i></a>
								  </div>
							  </td>
						  </tr> -->
					  </tbody>
					</table>
				</div>
				<div id="invitContacts" class="col s12 margin-top">
					<!-- Modal Trigger -->
					<a id="joinSalon" class="waves-effect waves-light" href="#modal1">
						Inviter un contact
						<div title="Inviter un contact" class="btn-floating btn-small red lighten-1">
							<i class="large material-icons">add</i>
						</div>
					</a>
				</div>
			</div>
		</div>         
    </div>
    <script>
		function addtoContacts(idContact, currentElement){
			$.ajax({
				url: "{{ path('salon_addToContacts') }}",
				method: "post",
				data: {
					idContact: idContact,
					}			
			}).done(function(msg){
				$("#nameAlert").html("Contact enregistré");
				$("#alert").click();
				currentElement.css("visibility", "hidden");
			});
		}
		
		function popupInvitContacts(idSalon){
			$.ajax({
				url: "{{ path('salon_chargeContacts') }}",
				method: "post",
				data: {
					idSalon: idSalon,
					}			
			}).done(function(msg){
				console.log(msg);
				var contacts = $.parseJSON(msg);
				$("#myContacts tbody").html("");			
				for(var i = 0; i<contacts.length; i++){
					$("#myContacts tbody").append("<tr><td><p><input type='checkbox' id='contact_"+contacts[i]['id']+"' name='myContacts[]'><label for='contact_"+contacts[i]['id']+"'></label></p></td><td>"+contacts[i]['nom']+"</td></tr>");
				}
			});
		}
		
		function invitContacts(idContacts){
			$.ajax({
				url: "{{ path('salon_invitContacts') }}",
				method: "post",
				data: {
					idSalon: idSalon,
					}			
			}).done(function(msg){
				console.log("contacts invités");
			});
		}
    </script>
{% endblock %}
